(()=>{"use strict";var e={d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{addTeam:()=>r,assignRanks:()=>g,createTeam:()=>c,getTeamByID:()=>m,getTeamByTicker:()=>i,getTeams:()=>s,rehydrateTeams:()=>l,removeTeamByID:()=>p,setTeamByID:()=>u,setTeams:()=>d});var n={};e.r(n),e.d(n,{addBonus:()=>C,applyBonuses:()=>k,createBonus:()=>w,getBonuses:()=>v,removeBonusByID:()=>S,setBonuses:()=>b});var a={};e.r(a),e.d(a,{addMatch:()=>P,createMatch:()=>B,getMatchByID:()=>D,getMatches:()=>I,reapplyBonusesToAllMatches:()=>M,removeMatchByID:()=>q,setMatchByID:()=>L,setMatches:()=>T,updateRecords:()=>x});let o=[];const s=()=>o,d=e=>o=e,c=(e,t,n,a,o=crypto.randomUUID())=>({name:e,race:t,coach:n,ticker:a,wins:0,draws:0,losses:0,leaguePoints:0,rank:1,totalTDs:0,totalCasualties:0,gamesPlayed:0,get record(){return`${this.wins}-${this.draws}-${this.losses}`},id:o}),l=e=>e.map((e=>{const t=c(e.name,e.race,e.coach,e.ticker);return t.id=e.id,t.wins=e.wins,t.draws=e.draws,t.losses=e.losses,t.leaguePoints=e.leaguePoints,t.rank=e.rank??null,t})),r=e=>o.push(e),i=e=>o.find((t=>t.ticker===e)),m=e=>o.find((t=>t.id===e)),u=(e,t)=>{const n=o.findIndex((t=>t.id===e));-1!==n?o[n]=t:console.warn(`setTeamByID: No team found with id ${e}`)},p=e=>{o.forEach(((t,n)=>{e===t.id&&o.splice(n,1)}))},g=()=>{let e=Array.from(o);for(let t=0;t<e.length;t++){let n=e[t].leaguePoints,a=t;for(let o=t+1;o<e.length;o++)e[o].leaguePoints>n&&(n=e[o].leaguePoints,a=o);let o=e[a];e[a]=e[t],e[t]=o}e.forEach(((e,t)=>{e.rank=t+1})),d(e)},h=(e,t)=>{localStorage.setItem(e,JSON.stringify(t))},y=e=>{const t=localStorage.getItem(e);return t?JSON.parse(t):null},f=(e,t,n)=>{h("teams",e.getTeams()),h("matches",t.getMatches()),h("bonuses",n.getBonuses())};let E=[];const v=()=>E,b=e=>E=e,w=(e,t,n,a,o)=>({name:e,type:t,description:n,count:a,points:o,id:crypto.randomUUID()}),C=e=>E.push(e),S=e=>{E.forEach(((t,n)=>{e===t.id&&E.splice(n,1)}))},k=(e,t,n,a,o,s)=>{let d=0,c=[];return E.forEach((l=>{if(!1===l.active)return;const r="opponent TDs"==l.type&&t<=l.count&&"win"==e||"opponent casualties"==l.type&&n>=l.count||"passes"==l.type&&a>=l.count,i="painted"==l.type&&o||"underdog"==l.type&&s;r?(d+=l.points,c.push(`${l.name}: +${l.points} points for ${l.count} ${l.type}`)):i&&(d+=l.points,c.push(`${l.name}: +${l.points} points`))})),{points:d,appliedBonuses:c}};let $=[];const I=()=>$,T=e=>$=e,B=(e,t,n,a,o,s,d,c,l,r,i,m,u,p=null)=>{let g=p||crypto.randomUUID(),h="draw",y="draw",f=0,E=0;n>a?(h="win",f+=3,y="loss",E+=1):n<a?(h="loss",f+=1,y="win",E+=3):(f+=2,E+=2);let v=k(h,a,c,o,l,i),b=k(y,n,d,s,r,m),w=v.points,C=E+b.points;return{date:u,id:g,teams:[{id:e,tds:n,painted:l,underdog:i,casualties:d,passes:o,result:h,basePoints:f,leaguePoints:f+w,bonusesApplied:v.appliedBonuses,isHome:!0},{id:t,tds:a,painted:r,underdog:m,casualties:c,passes:s,result:y,basePoints:E,leaguePoints:C,bonusesApplied:b.appliedBonuses,isHome:!1}]}},P=e=>$.push(e),q=e=>{$.forEach(((t,n)=>{e===t.id&&$.splice(n,1)}))},L=(e,t)=>{const n=$.findIndex((t=>t.id===e));-1!==n?$[n]=t:console.warn(`setMatchByID: No match found with id ${e}`)},D=e=>$.find((t=>t.id===e)),x=e=>{const t=I();e.forEach((e=>{e.wins=0,e.draws=0,e.losses=0,e.leaguePoints=0,e.totalTDs=0,e.totalCasualties=0,e.gamesPlayed=0})),t.forEach((t=>{t.teams.forEach((t=>{const n=e.find((e=>e.id===t.id));n&&(n.leaguePoints+=Number(t.leaguePoints),n.totalTDs+=Number(t.tds),n.totalCasualties+=Number(t.casualties),n.gamesPlayed+=1,"win"===t.result?n.wins+=1:"draw"===t.result?n.draws+=1:"loss"===t.result&&(n.losses+=1))}))}))},M=()=>{I().forEach((e=>{const[t,n]=e.teams,a=B(t.id,n.id,t.tds,n.tds,t.passes,n.passes,t.casualties,n.casualties,t.painted,n.painted,t.underdog,n.underdog,e.date);a.id=e.id,L(e.id,a)}))};let A=document.querySelector("#teams tbody");const N=e=>{for(;A.firstChild;)A.removeChild(A.firstChild);e.forEach((e=>{let t=document.createElement("tr");A.appendChild(t),t.dataset.teamId=e.id;let n=document.createElement("td");t.appendChild(n),n.textContent=e.rank;let a=document.createElement("td");t.appendChild(a),a.textContent=e.name;let o=document.createElement("td");t.appendChild(o),o.textContent=e.record;let s=document.createElement("td");t.appendChild(s),s.textContent=e.leaguePoints}))};let H=document.querySelector("#matches tbody");const U=e=>{for(;H.firstChild;)H.removeChild(H.firstChild);for(let t=e.length-1;t>=0;t--){const n=e[t],a=document.createElement("tr");H.appendChild(a),a.dataset.matchId=n.id;const o=n.teams.find((e=>e.isHome)),s=n.teams.find((e=>!e.isHome)),d=m(o.id)?.name||"Unknown",c=m(s.id)?.name||"Unknown",l=document.createElement("td");l.textContent=d,a.appendChild(l);const r=document.createElement("td");r.textContent=`${o.tds}-${s.tds}`,a.appendChild(r);const i=document.createElement("td");i.textContent=c,a.appendChild(i);const u=document.createElement("td");u.textContent=n.date||"N/A",a.appendChild(u)}},O=document.getElementById("home-select"),j=document.getElementById("away-select"),J=e=>{O.innerHTML='<option value="">-- Select Team --</option>',j.innerHTML='<option value="">-- Select Team --</option>',e.forEach((e=>{const t=document.createElement("option");t.value=e.id,t.textContent=`${e.name} (${e.ticker})`,O.appendChild(t.cloneNode(!0)),j.appendChild(t.cloneNode(!0))}))},R=document.getElementById("team-details-dialog"),W=document.getElementById("match-details-dialog"),z=document.getElementById("team-details-body"),F=document.getElementById("match-details-body");let _=null,G=null;const V=(e,t,n)=>{if(!e)return;G=e.id;const[a,o]=e.teams,d=e=>e&&0!==e.length?e.map((e=>`<li>${e}</li>`)).join(""):"<li>No bonuses earned.</li>";F.innerHTML=`\n        <div class="match-details-grid">\n            <div class="match-team-block">\n                <h4>${t?.name||"Unknown"} <span class="label">Home</span></h4>\n                <p><strong>TDs:</strong> ${a.tds}</p>\n                <p><strong>Casualties:</strong> ${a.casualties}</p>\n                <p><strong>Passes:</strong> ${a.passes}</p>\n                <p><strong>Result:</strong> ${ee(a.result)} (+${a.basePoints} points)</p>\n                <p><strong>League Points:</strong> ${a.leaguePoints}</p>\n                <p><strong>Bonuses:</strong></p>\n                <ul>${d(a.bonusesApplied)}</ul>\n            </div>\n\n            <div class="match-team-block">\n                <h4>${n?.name||"Unknown"} <span class="label">Away</span></h4>\n                <p><strong>TDs:</strong> ${o.tds}</p>\n                <p><strong>Casualties:</strong> ${o.casualties}</p>\n                <p><strong>Passes:</strong> ${o.passes}</p>\n                <p><strong>Result:</strong> ${ee(o.result)} (+${o.basePoints} points)</p>\n                <p><strong>League Points:</strong> ${o.leaguePoints}</p>\n                <p><strong>Bonuses:</strong></p>\n                <ul>${d(o.bonusesApplied)}</ul>\n            </div>\n        </div>\n        <p style="text-align:center; margin-top:1rem;"><strong>Date:</strong> ${e.date}</p>\n        `,document.getElementById("edit-match-btn").addEventListener("click",(()=>{te=e.id,re(!0);const t=e.teams.find((e=>e.isHome)),n=e.teams.find((e=>!e.isHome));J(s()),document.querySelector("#home-select").value=t.id,document.querySelector("#away-select").value=n.id,document.querySelector('[name="homeTDs"]').value=t.tds,document.querySelector('[name="awayTDs"]').value=n.tds,document.querySelector('[name="homePasses"]').value=t.passes,document.querySelector('[name="awayPasses"]').value=n.passes,document.querySelector('[name="homeCasualties"]').value=t.casualties,document.querySelector('[name="awayCasualties"]').value=n.casualties,document.querySelector('[name="homePainted"]').checked=t.painted,document.querySelector('[name="awayPainted"]').checked=n.painted,document.querySelector('[name="homeUnderdog"]').checked=t.underdog,document.querySelector('[name="awayUnderdog"]').checked=n.underdog,document.querySelector('[name="date"]').value=e.date,W.close(),document.getElementById("match-dialog").showModal()})),W.showModal()},K=document.querySelectorAll("input"),Q=document.querySelectorAll('input[type="number"]'),X=document.querySelectorAll("select"),Y=document.querySelectorAll('input[type="checkbox"]'),Z=()=>{K.forEach((e=>{e.value=" "})),Q.forEach((e=>{e.value=0})),X.forEach((e=>{e.selectedIndex=0})),Y.forEach((e=>{e.checked=!1}))},ee=e=>e.charAt(0).toUpperCase()+e.slice(1);let te=null;const ne=()=>te,ae=e=>te=e;let oe=null;const se=()=>oe,de=e=>oe=e,ce=document.querySelector("#match-dialog-title"),le=document.querySelector("#add-match-btn"),re=e=>{e?(ce.textContent="Edit Match",le.textContent="Apply Edits"):(ce.textContent="Add Match",le.textContent="Add Match")};let ie=w("Fully Painted Team","painted","1 point awarded if your team is painted to the 3 color minimum.",1,1),me=w("Vulgar Display of Power","opponent casualties","3 points (awarded if a team causes at least 3 casualties in a match)",3,3),ue=w("Aerial Domination","passes","3 points (for completing 3 successful passes in a match)",3,3),pe=w("Clean Sheet","opponent TDs","3 points (for holding opponents to zero touchdowns)",0,3),ge=w("It's Not the Size of the Dog...","underdog","3 points (for forcing a tie or win with a team value deficit of 150k or more)",1,3);document.addEventListener("DOMContentLoaded",(()=>{((e,t,n)=>{const a=y("teams"),o=y("matches"),s=y("bonuses");a&&e.setTeams(l(a)),o&&t.setMatches(o),s&&n.setBonuses(s)})(t,a,n),0===v().length&&(C(ie),C(me),C(ue),C(pe),C(ge)),(()=>{const e=document.getElementById("bonus-toggle-form");e.innerHTML="",v().forEach((t=>{const n=document.createElement("div");n.classList.add("bonus-toggle-label");const a=document.createElement("div");a.classList.add("bonus-toggle-top");const o=document.createElement("input");o.type="checkbox",o.name="bonusToggle",o.value=t.id,o.checked=t.active??!0,o.addEventListener("change",(e=>{t.active=e.target.checked,h("bonuses",v()),M(),x(s()),g(),U(I()),N(s())}));const d=document.createElement("span");d.textContent=t.name,a.appendChild(o),a.appendChild(d);const c=document.createElement("div");c.classList.add("bonus-detail"),c.textContent=t.description,n.addEventListener("click",(e=>{e.target!==o&&c.classList.toggle("show")})),n.appendChild(a),n.appendChild(c),e.appendChild(n)}))})(),x(s()),g(),Z(),N(s()),U(I())}));const he=document.getElementById("team-dialog"),ye=document.querySelector("#team-form #name-input"),fe=document.querySelector("#team-form #ticker-input");document.getElementById("new-team-btn").onclick=()=>{Z(),he.showModal()},document.getElementById("cancel-team-btn").onclick=()=>he.close(),ye.addEventListener("input",(()=>{const e=ye.value.trim().split(/\s+/).map((e=>e[0]?.toUpperCase()||"")).join("");fe.value=e.slice(0,3)})),document.querySelector("#add-team-btn").addEventListener("click",(e=>{e.preventDefault();const o=ye.value,d=fe.value,l=document.querySelector("#team-form #race-input").value,i=document.querySelector("#team-form #coach-input").value,m=se(),p=c(o,l,i,d,m||null);m?(u(m,p),de(null)):r(p),document.querySelector("#add-team-btn").textContent="Add Team",document.querySelector("#team-form-title").textContent="New Team",x(s()),g(),f(t,a,n),N(s()),Z(),he.close()}));const Ee=document.getElementById("match-dialog");document.getElementById("new-match-btn").onclick=()=>{J(s()),Z(),ae(null),re(!1),Ee.showModal()},document.getElementById("cancel-match-btn").onclick=()=>{ae(null),Ee.close()},document.querySelector("#add-match-btn").addEventListener("click",(e=>{e.preventDefault();const o=document.querySelector("#home-select").value,d=document.querySelector("#away-select").value;if(o===d)return void alert("A team cannot play against itself.");const c=e=>{const t=document.querySelector(`[name="${e}"]`);return"checkbox"===t.type?t.checked:t.value},l=ne(),r=B(o,d,c("homeTDs"),c("awayTDs"),c("homePasses"),c("awayPasses"),c("homeCasualties"),c("awayCasualties"),c("homePainted"),c("awayPainted"),c("homeUnderdog"),c("awayUnderdog"),c("date"),l||null);l?(L(l,r),ae(null)):P(r),x(s()),g(),f(t,a,n),N(s()),U(I()),Ee.close()})),document.querySelector("#teams tbody").addEventListener("click",(e=>{const t=e.target.closest("tr");if(t?.dataset.teamId){const e=m(t.dataset.teamId);e&&(e=>{if(!e)return;_=e.id,z.innerHTML="";const t=document.createElement("div");t.classList.add("team-stats"),z.appendChild(t),t.innerHTML=`\n        <p><strong>Name:</strong> ${e.name}</p>\n        <p><strong>Race:</strong> ${e.race}</p>\n        <p><strong>Coach:</strong> ${e.coach}</p>\n        <p><strong>Ticker:</strong> ${e.ticker}</p>\n        <p><strong>Record:</strong> ${e.wins}-${e.draws}-${e.losses}</p>\n        <p><strong>League Points:</strong> ${e.leaguePoints}</p>\n        <p><strong>Rank:</strong> ${e.rank}</p>\n        <p><strong>Total TDs:</strong> ${e.totalTDs}</p>\n        <p><strong>Total Casualties Caused:</strong> ${e.totalCasualties}</p>\n        <p><strong>Total Games Played:</strong> ${e.gamesPlayed}</p>\n        `,document.getElementById("edit-team-btn").addEventListener("click",(()=>{de(e.id),document.querySelector('[name="name"]').value=e.name,document.querySelector('[name="race"]').value=e.race,document.querySelector('[name="coach"]').value=e.coach,document.querySelector('[name="ticker"]').value=e.ticker,document.querySelector("#add-team-btn").textContent="Apply Edits",document.querySelector("#team-form-title").textContent="Edit Team",R.close(),document.getElementById("team-dialog").showModal()}));const n=I().filter((t=>t.teams.some((t=>t.id===e.id)))).sort(((e,t)=>new Date(t.date)-new Date(e.date))),a=document.createElement("div");a.classList.add("team-match-history");const o=document.createElement("h4");o.textContent="Match History",a.appendChild(o),n.forEach((t=>{const[n,o]=t.teams,s=n.id===e.id,d=s?n:o,c=s?o:n,l=m(c.id)?.name||"Unknown",r=d.result,i=s?`${n.tds}-${o.tds}`:`${o.tds}-${n.tds}`,u=t.date,p=document.createElement("div");p.classList.add("mini-match-row"),p.innerHTML=`\n            <span class="match-date">${u}</span>\n            <span class="opponent-name">${l}</span>\n            <span class="score">${i}</span>\n            <span class="result ${r}">${ee(r)}</span>\n        `,p.addEventListener("click",(()=>{V(t,m(n.id),m(o.id))})),a.appendChild(p)})),z.appendChild(a),R.showModal()})(e)}})),document.querySelector("#matches tbody").addEventListener("click",(e=>{const t=e.target.closest("tr");if(t?.dataset.matchId){const e=I().find((e=>e.id===t.dataset.matchId));if(e){const t=e.teams.find((e=>e.isHome)),n=e.teams.find((e=>!e.isHome)),a=m(t.id),o=m(n.id);V(e,a,o)}}})),document.getElementById("delete-team-btn").addEventListener("click",(()=>{p(_),g(),f(t,a,n),N(s()),U(I()),document.getElementById("team-details-dialog").close()})),document.getElementById("delete-match-btn").addEventListener("click",(()=>{q(G),x(s()),g(),f(t,a,n),U(I()),N(s()),document.getElementById("match-details-dialog").close()}));const ve=document.getElementById("json-input"),be=document.getElementById("export-json"),we=document.getElementById("import-json");be.addEventListener("click",(()=>{const e={version:1,teams:s(),matches:I(),bonuses:v()},t=JSON.stringify(e,null,2);navigator.clipboard.writeText(t).then((()=>{alert("League data copied to clipboard!")})).catch((e=>{alert("Failed to copy JSON to clipboard"),console.error(e)}))})),we.addEventListener("click",(async()=>{let e=ve.value.trim();if(!e)try{if(e=await navigator.clipboard.readText(),!e.trim())return alert("Clipboard is empty or invalid.")}catch(e){return alert("Could not read from clipboard.")}try{const t=JSON.parse(e);if(console.log(t),!(t&&Array.isArray(t.teams)&&Array.isArray(t.matches)&&Array.isArray(t.bonuses)))return alert("Invalid JSON structure: expected { teams, matches, bonuses }");d(t.teams),T(t.matches),b(t.bonuses),h("teams",t.teams),h("matches",t.matches),h("bonuses",t.bonuses),console.log("Working here?"),x(s()),g(),console.log("Working here?"),N(s()),U(I()),console.log("Working here?"),alert("League data successfully imported!")}catch(e){console.error(e),alert("Error importing data. Please make sure itâ€™s valid JSON.")}}))})();
//# sourceMappingURL=main.js.map